{"ast":null,"code":"import React,{useState,useEffect,useContext}from'react';import{useParams,useNavigate,Link}from'react-router-dom';import{AuthContext}from'../contexts/AuthContext';import{getTournamentById}from'../services/tournamentService';import{getTeamsByTournament,joinTeam}from'../services/teamService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TournamentDetail=()=>{const{tournamentId}=useParams();const[tournament,setTournament]=useState(null);const[teams,setTeams]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[joinLoading,setJoinLoading]=useState(false);const{user}=useContext(AuthContext);const navigate=useNavigate();useEffect(()=>{if(!user){navigate('/login');return;}const fetchTournamentData=async()=>{try{const tournamentData=await getTournamentById(tournamentId);setTournament(tournamentData);const teamsData=await getTeamsByTournament(tournamentId);setTeams(teamsData);}catch(err){setError('Impossible de récupérer les informations du tournoi');console.error(err);}finally{setLoading(false);}};fetchTournamentData();},[tournamentId,user,navigate]);const handleJoinTeam=async teamId=>{setJoinLoading(true);try{await joinTeam(teamId);// Rafraîchir la liste des équipes\nconst teamsData=await getTeamsByTournament(tournamentId);setTeams(teamsData);}catch(err){setError('Impossible de rejoindre l\\'équipe');console.error(err);}finally{setJoinLoading(false);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-xl\",children:\"Chargement du tournoi...\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-100\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"bg-white shadow-md p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold\",children:(tournament===null||tournament===void 0?void 0:tournament.name)||'Détails du tournoi'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(Link,{to:`/tournaments/${tournamentId}/ranking`,className:\"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition\",children:\"Classement\"}),/*#__PURE__*/_jsx(Link,{to:\"/tournaments\",className:\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition\",children:\"Retour aux tournois\"})]})]})}),/*#__PURE__*/_jsxs(\"main\",{className:\"container mx-auto py-8\",children:[error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-6 mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold mb-4\",children:\"\\xC9quipes participantes\"}),teams.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:teams.map(team=>{var _team$captain,_team$members;return/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-lg mb-2\",children:team.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mb-2\",children:[\"Capitaine: \",((_team$captain=team.captain)===null||_team$captain===void 0?void 0:_team$captain.name)||'Non défini']}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mb-4\",children:[\"Membres: \",((_team$members=team.members)===null||_team$members===void 0?void 0:_team$members.length)||0,\"/\",team.maxMembers||5]}),team.members&&!team.members.some(member=>member.id===user.id)&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleJoinTeam(team.id),disabled:joinLoading,className:\"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition disabled:opacity-50\",children:joinLoading?'Traitement...':'Rejoindre'})]},team.id);})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Aucune \\xE9quipe n'a encore \\xE9t\\xE9 cr\\xE9\\xE9e pour ce tournoi.\"})]})]})]});};export default TournamentDetail;","map":{"version":3,"names":["React","useState","useEffect","useContext","useParams","useNavigate","Link","AuthContext","getTournamentById","getTeamsByTournament","joinTeam","jsx","_jsx","jsxs","_jsxs","TournamentDetail","tournamentId","tournament","setTournament","teams","setTeams","loading","setLoading","error","setError","joinLoading","setJoinLoading","user","navigate","fetchTournamentData","tournamentData","teamsData","err","console","handleJoinTeam","teamId","className","children","name","to","length","map","team","_team$captain","_team$members","captain","members","maxMembers","some","member","id","onClick","disabled"],"sources":["/root/projet/module-133-classe-300231-valleliant/projet/client1/src/pages/TournamentDetail.jsx"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport { useParams, useNavigate, Link } from 'react-router-dom';\nimport { AuthContext } from '../contexts/AuthContext';\nimport { getTournamentById } from '../services/tournamentService';\nimport { getTeamsByTournament, joinTeam } from '../services/teamService';\n\nconst TournamentDetail = () => {\n  const { tournamentId } = useParams();\n  const [tournament, setTournament] = useState(null);\n  const [teams, setTeams] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [joinLoading, setJoinLoading] = useState(false);\n  \n  const { user } = useContext(AuthContext);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (!user) {\n      navigate('/login');\n      return;\n    }\n\n    const fetchTournamentData = async () => {\n      try {\n        const tournamentData = await getTournamentById(tournamentId);\n        setTournament(tournamentData);\n        \n        const teamsData = await getTeamsByTournament(tournamentId);\n        setTeams(teamsData);\n      } catch (err) {\n        setError('Impossible de récupérer les informations du tournoi');\n        console.error(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchTournamentData();\n  }, [tournamentId, user, navigate]);\n\n  const handleJoinTeam = async (teamId) => {\n    setJoinLoading(true);\n    try {\n      await joinTeam(teamId);\n      // Rafraîchir la liste des équipes\n      const teamsData = await getTeamsByTournament(tournamentId);\n      setTeams(teamsData);\n    } catch (err) {\n      setError('Impossible de rejoindre l\\'équipe');\n      console.error(err);\n    } finally {\n      setJoinLoading(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <p className=\"text-xl\">Chargement du tournoi...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-100\">\n      <header className=\"bg-white shadow-md p-4\">\n        <div className=\"container mx-auto flex justify-between items-center\">\n          <h1 className=\"text-2xl font-bold\">{tournament?.name || 'Détails du tournoi'}</h1>\n          <div className=\"flex space-x-4\">\n            <Link \n              to={`/tournaments/${tournamentId}/ranking`}\n              className=\"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition\"\n            >\n              Classement\n            </Link>\n            <Link \n              to=\"/tournaments\"\n              className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition\"\n            >\n              Retour aux tournois\n            </Link>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"container mx-auto py-8\">\n        {error && (\n          <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\">\n            {error}\n          </div>\n        )}\n\n        <div className=\"bg-white rounded-lg shadow p-6 mb-8\">\n          <h2 className=\"text-xl font-semibold mb-4\">Équipes participantes</h2>\n          \n          {teams.length > 0 ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {teams.map((team) => (\n                <div key={team.id} className=\"border rounded p-4\">\n                  <h3 className=\"font-medium text-lg mb-2\">{team.name}</h3>\n                  <p className=\"text-gray-600 mb-2\">\n                    Capitaine: {team.captain?.name || 'Non défini'}\n                  </p>\n                  <p className=\"text-gray-600 mb-4\">\n                    Membres: {team.members?.length || 0}/{team.maxMembers || 5}\n                  </p>\n                  \n                  {team.members && !team.members.some(member => member.id === user.id) && (\n                    <button\n                      onClick={() => handleJoinTeam(team.id)}\n                      disabled={joinLoading}\n                      className=\"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition disabled:opacity-50\"\n                    >\n                      {joinLoading ? 'Traitement...' : 'Rejoindre'}\n                    </button>\n                  )}\n                </div>\n              ))}\n            </div>\n          ) : (\n            <p className=\"text-gray-600\">\n              Aucune équipe n'a encore été créée pour ce tournoi.\n            </p>\n          )}\n        </div>\n      </main>\n    </div>\n  );\n};\n\nexport default TournamentDetail; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}