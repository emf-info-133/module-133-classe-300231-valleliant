{"ast":null,"code":"import React,{createContext,useState,useEffect}from'react';import{loginUser,registerUser,getUser}from'../services/authService';import{jsx as _jsx}from\"react/jsx-runtime\";export const AuthContext=/*#__PURE__*/createContext();export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{const token=localStorage.getItem('token');if(token){getUser(token).then(userData=>{setUser(userData);}).catch(err=>{localStorage.removeItem('token');}).finally(()=>{setLoading(false);});}else{setLoading(false);}},[]);const login=async(email,password)=>{setError(null);try{const data=await loginUser(email,password);localStorage.setItem('token',data.token);setUser(data.user);return data.user;}catch(err){setError(err.message||'Échec de la connexion');throw err;}};const register=async(name,email,password)=>{setError(null);try{const data=await registerUser(name,email,password);localStorage.setItem('token',data.token);setUser(data.user);return data.user;}catch(err){setError(err.message||'Échec de l\\'inscription');throw err;}};const logout=()=>{localStorage.removeItem('token');setUser(null);};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,loading,error,login,register,logout},children:children});};","map":{"version":3,"names":["React","createContext","useState","useEffect","loginUser","registerUser","getUser","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","loading","setLoading","error","setError","token","localStorage","getItem","then","userData","catch","err","removeItem","finally","login","email","password","data","setItem","message","register","name","logout","Provider","value"],"sources":["/root/projet/module-133-classe-300231-valleliant/projet/client1/src/contexts/AuthContext.jsx"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\nimport { loginUser, registerUser, getUser } from '../services/authService';\n\nexport const AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      getUser(token)\n        .then(userData => {\n          setUser(userData);\n        })\n        .catch(err => {\n          localStorage.removeItem('token');\n        })\n        .finally(() => {\n          setLoading(false);\n        });\n    } else {\n      setLoading(false);\n    }\n  }, []);\n\n  const login = async (email, password) => {\n    setError(null);\n    try {\n      const data = await loginUser(email, password);\n      localStorage.setItem('token', data.token);\n      setUser(data.user);\n      return data.user;\n    } catch (err) {\n      setError(err.message || 'Échec de la connexion');\n      throw err;\n    }\n  };\n\n  const register = async (name, email, password) => {\n    setError(null);\n    try {\n      const data = await registerUser(name, email, password);\n      localStorage.setItem('token', data.token);\n      setUser(data.user);\n      return data.user;\n    } catch (err) {\n      setError(err.message || 'Échec de l\\'inscription');\n      throw err;\n    }\n  };\n\n  const logout = () => {\n    localStorage.removeItem('token');\n    setUser(null);\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, loading, error, login, register, logout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}